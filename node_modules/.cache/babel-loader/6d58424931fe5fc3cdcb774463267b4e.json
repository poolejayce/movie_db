{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\jayce\\\\Documents\\\\movie_db\\\\movie_db\\\\src\\\\components\\\\Typeahead\\\\Typeahead.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { AsyncTypeahead } from 'react-bootstrap-typeahead';\nimport TypeaheadResults from './TypeaheadResults/TypeaheadResults';\nimport './Typeahead.css';\nconst apiKey = '6e92bc67004a571503673da0fd8facc1';\nconst searchUrl = 'https://api.themoviedb.org/3/';\n\nconst Typeahead = () => {\n  _s();\n\n  const [loading, setLoading] = useState(false);\n  const [query, setQuery] = useState('');\n  const [options, setOptions] = useState([]);\n  let cache = {};\n\n  const makeAndHandleRequest = async (query, page = 1) => {\n    console.log('request');\n    return await fetch(`${searchUrl}search/multi?page=1&query=${query}&api_key=${apiKey}&page=${page}&region=840`).then(resp => resp.json()).then(({\n      page,\n      results,\n      total_results,\n      total_pages\n    }) => {\n      const options = results.map(i => ({\n        id: i.id,\n        posterPath: i.poster_path,\n        mediaType: i.media_type,\n        name: i.name\n      }));\n      return {\n        options,\n        page,\n        total_results,\n        total_pages\n      };\n    });\n  };\n\n  const handleInputChange = query => {\n    setQuery(query);\n    makeAndHandleRequest(query).then(resp => {\n      cache[query] = { ...resp,\n        page: 1\n      };\n      setLoading(false);\n      setOptions(resp.options);\n    });\n  };\n\n  const handlePagination = (e, shownResults) => {\n    const cachedQuery = cache[query];\n\n    if (cachedQuery.options.length > shownResults || cachedQuery.options.length === cachedQuery.total_count) {\n      return;\n    }\n\n    setLoading(true);\n    const page = cachedQuery.page + 1;\n    makeAndHandleRequest(query, page).then(resp => {\n      const options = cachedQuery.options.concat(resp.options);\n      cache[query] = { ...cachedQuery,\n        options,\n        page\n      };\n      setLoading(false);\n      setOptions(options);\n    });\n  };\n\n  const handleSearch = query => {\n    if (cache[query]) {\n      setOptions(cache[query].options);\n      return;\n    }\n\n    setLoading(true);\n    makeAndHandleRequest(query).then(resp => {\n      cache[query] = { ...resp,\n        page: 1\n      };\n      setLoading(false);\n      setOptions(resp.options);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"async-typeahead-wrapper\",\n    children: /*#__PURE__*/_jsxDEV(AsyncTypeahead, {\n      isLoading: loading,\n      delay: 250,\n      id: \"async-typeahead\",\n      labelKey: \"name\",\n      maxResults: 20,\n      minLength: 2,\n      onInputChange: handleInputChange,\n      onPaginate: handlePagination,\n      onSearch: handleSearch,\n      options: options,\n      paginate: true,\n      promptText: \"Search movies, TV shows, and celebrities\",\n      searchText: \"Searching..\",\n      renderMenuItemChildren: option => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: option.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 25\n        }, this)\n      }, option.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 21\n      }, this),\n      query: query\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Typeahead, \"fDLBNlxpnh1vIKh8srSnjBy2Zx0=\");\n\n_c = Typeahead;\nexport default Typeahead;\n\nvar _c;\n\n$RefreshReg$(_c, \"Typeahead\");","map":{"version":3,"sources":["C:/Users/jayce/Documents/movie_db/movie_db/src/components/Typeahead/Typeahead.js"],"names":["React","useState","AsyncTypeahead","TypeaheadResults","apiKey","searchUrl","Typeahead","loading","setLoading","query","setQuery","options","setOptions","cache","makeAndHandleRequest","page","console","log","fetch","then","resp","json","results","total_results","total_pages","map","i","id","posterPath","poster_path","mediaType","media_type","name","handleInputChange","handlePagination","e","shownResults","cachedQuery","length","total_count","concat","handleSearch","option"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\r\nimport {AsyncTypeahead} from 'react-bootstrap-typeahead';\r\n\r\nimport TypeaheadResults from './TypeaheadResults/TypeaheadResults';\r\nimport './Typeahead.css';\r\n\r\nconst apiKey = '6e92bc67004a571503673da0fd8facc1';\r\nconst searchUrl = 'https://api.themoviedb.org/3/';\r\n\r\nconst Typeahead = () => {\r\n    const [loading, setLoading] = useState(false);\r\n    const [query, setQuery] = useState('');\r\n    const [options, setOptions] = useState([]);\r\n\r\n    let cache = {};\r\n\r\n    const makeAndHandleRequest = async (query, page = 1) => {\r\n        console.log('request');\r\n        return await fetch(`${searchUrl}search/multi?page=1&query=${query}&api_key=${apiKey}&page=${page}&region=840`)\r\n        .then(resp => resp.json())\r\n        .then(({page, results, total_results, total_pages}) => {\r\n            const options = results.map(i => ({\r\n                id: i.id,\r\n                posterPath: i.poster_path,\r\n                mediaType: i.media_type,\r\n                name: i.name\r\n            }));\r\n            return {options, page, total_results, total_pages};\r\n        })\r\n    }\r\n\r\n    const handleInputChange = (query) => {\r\n        setQuery(query);\r\n        makeAndHandleRequest(query).then(resp => {\r\n            cache[query] = { ...resp, page: 1};\r\n            setLoading(false);\r\n            setOptions(resp.options);\r\n        });\r\n    }\r\n\r\n    const handlePagination = (e, shownResults) => {\r\n        const cachedQuery = cache[query];\r\n\r\n        if (\r\n            cachedQuery.options.length > shownResults ||\r\n            cachedQuery.options.length === cachedQuery.total_count\r\n        ) {\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n\r\n        const page = cachedQuery.page + 1;\r\n\r\n        makeAndHandleRequest(query, page).then(resp => {\r\n            const options = cachedQuery.options.concat(resp.options);\r\n            cache[query] = { ...cachedQuery, options, page};\r\n            setLoading(false);\r\n            setOptions(options);\r\n        })\r\n\r\n    };\r\n\r\n    const handleSearch = (query) => {\r\n        if (cache[query]) {\r\n            setOptions(cache[query].options);\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        makeAndHandleRequest(query).then(resp => {\r\n            cache[query] = { ...resp, page: 1};\r\n            setLoading(false);\r\n            setOptions(resp.options);\r\n        });\r\n    };\r\n\r\n     \r\n\r\n    return(\r\n        <div className='async-typeahead-wrapper'>\r\n            <AsyncTypeahead \r\n                isLoading={loading} \r\n                delay={250}\r\n                id='async-typeahead'\r\n                labelKey='name'\r\n                maxResults={20}\r\n                minLength={2}\r\n                onInputChange={handleInputChange}\r\n                onPaginate={handlePagination}\r\n                onSearch={handleSearch}\r\n                options={options}\r\n                paginate\r\n                promptText=\"Search movies, TV shows, and celebrities\"\r\n                searchText=\"Searching..\"\r\n                renderMenuItemChildren={(option) => (\r\n                    <div key={option.id}>\r\n                        <span>{option.name}</span>\r\n                    </div>\r\n                )}\r\n                query={query}>\r\n            </AsyncTypeahead>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Typeahead;"]},"metadata":{},"sourceType":"module"}